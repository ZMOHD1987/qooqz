/* admin/assets/css/admin.css
   Server-driven theme stylesheet (DB-driven).
   - ALL themeable values (colors, fonts, spacing, sizes) are driven by CSS variables
     injected by admin_core.syncThemeVarsFromAdminUI() from server tables.
   - Variable naming convention: --theme-<setting_key>
     Example keys commonly used by admin_core: primary, primary-hover, background,
     background-secondary, text-primary, text-secondary, border, surface, sidebar-width, sidebar-background, sidebar-text, sidebar-border, sidebar-toggle-bg, sidebar-toggle-bg-hover, font-family, etc.
   - This file provides layout and safe fallbacks that reference the --theme- variables.
   - If legacy CSS or overrides expect different names, compatibility aliases are provided below.
   - Save as UTF-8 without BOM.
*/

/* ----------------------
   Compatibility aliases
   - Map older/alternate names to canonical --theme-... variables so overrides work.
   ---------------------- */
:root{
  /* canonical theme aliases (map legacy names to canonical theme vars) */
  --color-primary: var(--theme-primary, #3B82F6);
  --color-primary-dark: var(--theme-primary-hover, #2563EB);
  --color-secondary: var(--theme-secondary, #10B981);
  --color-accent: var(--theme-accent, #F59E0B);

  --color-surface: var(--theme-surface, var(--theme-background-secondary, #F8FAFC));
  --color-background: var(--theme-background, #ffffff);
  --color-background-secondary: var(--theme-background-secondary, #F8FAFC);

  --color-text: var(--theme-text-primary, #111827);
  --color-text-muted: var(--theme-text-secondary, #6B7280);
  --color-border: var(--theme-border, #E5E7EB);

  --sidebar-width: var(--theme-sidebar-width, 280px);
  --sidebar-bg: var(--theme-sidebar-background, var(--color-surface));
  --sidebar-text: var(--theme-sidebar-text, var(--color-text));
  --sidebar-border: var(--theme-sidebar-border, var(--color-border));

  --sidebar-toggle-bg: var(--theme-sidebar-toggle-bg, var(--color-primary));
  --sidebar-toggle-bg-hover: var(--theme-sidebar-toggle-bg-hover, var(--color-primary-dark));
  --sidebar-toggle-color: var(--theme-sidebar-toggle-color, #fff);

  --theme-font-family: var(--theme-font-family, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif);
  --theme-font-size: var(--theme-font-size, 14px);
  --theme-line-height: var(--theme-line-height, 1.45);

  /* card & control defaults */
  --card-radius: var(--theme-card-radius, 8px);
  --btn-radius: var(--theme-btn-radius, 6px);
  --btn-padding: var(--theme-btn-padding, 10px 16px);

  --z-top: var(--theme-z-top, 1400);
}

/* ----------------------
   Global base
   ---------------------- */
html, body {
  height: 100%;
  margin: 0;
  font-family: var(--theme-font-family);
  font-size: var(--theme-font-size);
  line-height: var(--theme-line-height);
  color: var(--color-text);
  background: var(--color-background);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

*, *::before, *::after { box-sizing: border-box; }

/* Links */
a { color: var(--color-primary); text-decoration: none; }
a:hover { text-decoration: underline; }

/* ----------------------
   Header / Brand / Toggle
   ---------------------- */
.admin-header {
  display: flex;
  align-items: center;
  gap: 12px;
  height: var(--theme-header-height, 64px);
  padding: 0 12px;
  background: var(--color-surface);
  border-bottom: 1px solid var(--color-border);
  position: relative;
  z-index: calc(var(--z-top) + 100);
}
.brand img,
.site-logo img,
.header-logo img {
  height: var(--theme-logo-height, 40px);
  width: auto;
  max-height: 100%;
  object-fit: contain;
}


.header-left, .header-center, .header-right {
  display: flex;
  align-items: center;
  gap: 10px;
}

.brand { display:flex; align-items:center; gap:10px; }

/* Sidebar toggle */
#sidebarToggle {
  position: absolute;
  top: 50%;
  transform: translateY(-50%);
  width: 44px;
  height: 44px;
  background: var(--sidebar-toggle-bg);
  color: var(--sidebar-toggle-color);
  border: none;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  border-radius: calc(var(--btn-radius));
  z-index: calc(var(--z-top) + 200);
  transition: background .18s ease, transform .12s ease;
}
#sidebarToggle:hover { background: var(--sidebar-toggle-bg-hover); }

/* ensure accessible focus */
a:focus, button:focus, input:focus { outline: 3px solid rgba(59,130,246,0.18); outline-offset: 2px; }

/* ----------------------
   Layout: Sidebar & Main
   ---------------------- */
.admin-layout { display:flex; min-height: calc(100vh - var(--theme-header-height, 64px)); }

.admin-sidebar, #adminSidebar, aside.admin-sidebar {
  position: fixed;
  top: var(--theme-header-height, 64px);
  left: 0;
  width: var(--sidebar-width);
  max-width: 90vw;
  height: calc(100vh - var(--theme-header-height, 64px));
  background: var(--sidebar-bg);
  color: var(--sidebar-text);
  border-right: 1px solid var(--sidebar-border);
  transform: translateX(-115%);
  transition: transform .22s ease, visibility .22s, opacity .22s ease;
  visibility: hidden;
  z-index: calc(var(--z-top) - 50);
  overflow:auto;
  padding: 12px;
  -webkit-overflow-scrolling: touch;
}

/* RTL mirror */
[dir="rtl"] .admin-sidebar { left: auto; right: 0; border-left: 1px solid var(--sidebar-border); border-right: none; transform: translateX(115%); }

/* shown */
body.sidebar-open .admin-sidebar,
body.sidebar-open #adminSidebar { transform: translateX(0); visibility: visible; opacity: 1; }

/* backdrop */
.sidebar-backdrop {
  position: fixed;
  inset: 0;
  display: none;
  background: rgba(0,0,0,0.35);
  z-index: calc(var(--z-top) - 100);
  opacity: 0;
  transition: opacity .22s ease;
}
body.sidebar-open .sidebar-backdrop { display:block; opacity:1; }

/* main content */
.admin-main {
  flex: 1 1 auto;
  margin-top: var(--theme-header-height, 64px);
  padding: 20px;
  transition: margin-left .22s ease, margin-right .22s ease;
}
@media (min-width:1100px) {
  body.sidebar-open .admin-main { margin-left: var(--sidebar-width); }
  [dir="rtl"] body.sidebar-open .admin-main { margin-left: 0; margin-right: var(--sidebar-width); }
}

/* ----------------------
   Buttons: base + helpers
   - Detailed styles for .btn-<slug> are generated client-side and will override these when present.
   - These base rules use theme variables so that generic buttons can also follow theme.
   ---------------------- */
.btn {
  display:inline-flex;
  align-items:center;
  justify-content:center;
  gap:.5rem;
  padding: var(--btn-padding);
  border-radius: var(--btn-radius);
  cursor:pointer;
  text-decoration:none;
  border: 0;
  font: inherit;
  color: var(--color-text);
  background: transparent;
  transition: background .15s ease, color .15s ease, transform .08s ease;
}

.btn:active { transform: translateY(1px); }

.btn-sm { padding: 6px 10px; font-size: 13px; }
.btn-lg { padding: 12px 20px; font-size: 16px; }

/* Provide a simple "primary" helper in case DB-generated rule missing */
.btn-primary {
  background: var(--theme-primary, var(--color-primary));
  color: var(--theme-primary-text, #fff);
  border-radius: var(--btn-radius);
  padding: var(--btn-padding);
}

/* simple utility classes */
.text-primary { color: var(--color-primary) !important; }
.text-muted { color: var(--color-text-muted) !important; }
.bg-surface { background: var(--color-surface) !important; }

/* ----------------------
   Cards
   ---------------------- */
.card {
  background: var(--color-surface);
  border: 1px solid var(--color-border);
  border-radius: var(--card-radius);
  padding: 16px;
  box-shadow: 0 6px 22px rgba(15,23,42,0.06);
  transition: transform .18s ease, box-shadow .18s ease;
  color: var(--color-text);
}

.card .card-title { font-weight: 600; margin-bottom: 8px; color: var(--color-text); }

/* ----------------------
   Forms & inputs
   ---------------------- */
.input, input[type="text"], input[type="search"], textarea, select {
  display:block;
  width:100%;
  padding:8px 10px;
  border:1px solid var(--color-border);
  border-radius:6px;
  background: var(--theme-input-bg, #fff);
  color:var(--color-text);
  font: inherit;
}

/* ----------------------
   Layout utilities
   ---------------------- */
.row { display:flex; flex-wrap:wrap; gap:12px; }
.col { flex:1 1 0; min-width:0; }

.badge { display:inline-flex; align-items:center; justify-content:center; padding:6px 10px; border-radius:999px; background:var(--color-border); color:var(--color-text); font-size:13px; }

/* Sidebar links */
.sidebar-list { list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:6px; }
.sidebar-link {
  display:flex;
  align-items:center;
  gap:10px;
  padding:8px 10px;
  border-radius:6px;
  color: var(--sidebar-text);
  text-decoration:none;
  transition: background .12s ease, color .12s ease;
}
.sidebar-link:hover { background: rgba(255,255,255,0.02); color: var(--sidebar-text); }

/* If nav_font provided in DB, admin_core sets --theme-font-family; allow nav override via CSS var */
.sidebar-link, .admin-sidebar { font-family: var(--theme-nav-font-family, var(--theme-font-family)); font-size: var(--theme-nav-font-size, 15px); }

/* ----------------------
   Accessibility helpers
   ---------------------- */
.sr-only { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }

/* ----------------------
   Responsive tweaks
   ---------------------- */
@media (max-width: 900px) {
  .admin-sidebar, #adminSidebar { width: min(80vw, var(--sidebar-width)); }
  body.sidebar-open .admin-main { margin-left: 0; margin-right: 0; }
}
/* Sidebar card & nav font styling (DB-driven) */
.admin-sidebar .card {
  background: var(--theme-sidebar-card-background, var(--theme-sidebar-background));
  color: var(--theme-sidebar-card-text, var(--theme-sidebar-text));
  border: 1px solid rgba(255,255,255,0.04);
  border-radius: 8px;
  padding: 12px;
  margin-bottom: 10px;
  box-shadow: 0 6px 18px rgba(2,6,23,0.45);
}

/* Ensure links and nav items use the nav font set in DB */
.admin-sidebar,
.admin-sidebar .sidebar-link,
.admin-sidebar .sidebar-link * {
  font-family: var(--theme-nav-font-family, var(--theme-font-family)) !important;
  font-size: var(--theme-nav-font-size, 15px) !important;
  color: var(--theme-sidebar-text) !important;
}

/* Make sure card text contrasts on mobile as well */
@media (max-width:900px) {
  .admin-sidebar .card { padding: 10px; margin-bottom: 10px; }
  .admin-sidebar .sidebar-link { font-size: calc(var(--theme-nav-font-size, 15px) - 1px); padding: 10px; }
}
#sidebarToggle,
#sidebarToggle * {
  color: var(--sidebar-toggle-color, #fff) !important;
  fill: var(--sidebar-toggle-color, #fff) !important;
}
#sidebarToggle:hover,
#sidebarToggle:hover * {
  color: var(--sidebar-toggle-color, #fff) !important;
  fill: var(--sidebar-toggle-color, #fff) !important;
}

/* ----------------------
   Color Slider Base Styles
   ---------------------- */
/* Note: Full color slider styles are in color-slider.css.
   These are minimal fallbacks for integration with admin theme. */
.color-slider-container {
  font-family: var(--theme-font-family);
}

.color-slider-container * {
  box-sizing: border-box;
}

/* ----------------------
   Debug helpers (optional)
   ---------------------- */
/* Uncomment during development */
/*
:root { outline: 2px dashed rgba(59,130,246,0.06); }
*/

/* ----------------------
   Notes:
   - All theme values should be provided from the server via window.ADMIN_UI.theme (syncThemeVarsFromAdminUI).
   - To control the sidebar appearance from DB, add keys such as:
       design_settings.sidebar_width -> --theme-sidebar-width
       color_settings.sidebar_background -> --theme-sidebar-background
       color_settings.sidebar_text -> --theme-sidebar-text
       color_settings.sidebar_border -> --theme-sidebar-border
       color_settings.sidebar_toggle_bg -> --theme-sidebar-toggle-bg
       color_settings.sidebar_toggle_bg_hover -> --theme-sidebar-toggle-bg-hover
       font_settings.nav_font -> set --theme-nav-font-family and --theme-nav-font-size (admin_core may set these)
   - Component-specific .btn-<slug> and .card-<slug> rules are generated client-side and will override these fallbacks.
   ---------------------- */